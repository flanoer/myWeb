<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Sample">

	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="searchVO" type="egovframework.example.sample.service.SampleDefaultVO"/>

	<resultMap id="sample" class="egovframework.example.sample.service.SampleVO">
		<result property="id" column="id"/>
		<result property="name" column="name"/>
		<result property="description" column="description"/>
		<result property="useYn" column="use_yn"/>
		<result property="regUser" column="reg_user"/>
		<result property="usr_pwd" column="usr_pwd"/>
		<result property="sdate" column="sdate"/>
		<result property="edate" column="edate"/>
		<result property="noti_yn" column="noti_yn"/>
	</resultMap>

	<insert id="sampleDAO.insertSample">
		<![CDATA[
		INSERT INTO UTBL 
			( ID
			  , NAME
			  , DESCRIPTION
			  , USE_YN
			  , REG_USER
			  , USR_PWD
			  , SDATE
			  , EDATE
			  , NOTI_YN)
		VALUES ( #id#
			  , #name#
			  , #description#
			  , #useYn#
			  , #regUser#
			  , #usr_pwd#
			  , #sdate#
			  , #edate#
			  , #noti_yn# )
		]]>
	</insert>
	
	<update id="sampleDAO.updateSample">
		<![CDATA[
		UPDATE UTBL
		SET ID=#id#
			, NAME=#name#
			, DESCRIPTION=#description#
			, USE_YN=#useYn#
			, USR_PWD=#usr_pwd#
			, SDATE=#sdate#
			, EDATE=#edate#
			, NOTI_YN=#noti_yn#
		WHERE ID=#id#
		]]>
	</update>
	
	<delete id="sampleDAO.deleteSample">
		<![CDATA[
		DELETE FROM UTBL 
		WHERE ID=#id#
		]]>
	</delete>
    
    <select id="sampleDAO.selectSample" resultMap="sample">
        <![CDATA[
		SELECT
		    ID, NAME, DESCRIPTION, USE_YN, REG_USER, USR_PWD, SDATE, EDATE, NOTI_YN
		FROM UTBL 
		WHERE ID=#id#
        ]]>
    </select>
	
    <select id="sampleDAO.selectSamplePwdCheck" resultClass="int">
		SELECT
		    COUNT(*)
		FROM UTBL 
		WHERE ID=#id# and USR_PWD=#usr_pwd#
    </select>

	<select id="sampleDAO.selectSampleList" parameterClass="searchVO" resultClass="egovMap">
		SELECT T2.ID, T2.NAME, T2.DESCRIPTION, T2.USE_YN, T2.REG_USER, T2.USR_PWD, T2.SDATE, T2.EDATE, T2.NOTI_YN, ROWNUM FROM(  
			SELECT ROWNUM RNUM, T1.* FROM(
			    SELECT
			    ID, NAME, DESCRIPTION, USE_YN, REG_USER, USR_PWD, SDATE, EDATE, NOTI_YN
			    FROM UTBL
			    WHERE 1=1
			    <isEqual prepend="AND" property="searchCondition" compareValue="0">
					ID LIKE '%' || #searchKeyword# || '%'
				</isEqual>
				<isEqual prepend="AND" property="searchCondition" compareValue="1">
					NAME LIKE '%' || #searchKeyword# || '%'
				</isEqual>
			    ORDER BY ID DESC
			    )T1
			)T2
<![CDATA[WHERE ROWNUM <= #recordCountPerPage# AND RNUM > #firstIndex#]]>		
	</select>
	
	<select id="sampleDAO.selectSampleListTotCnt" parameterClass="searchVO" resultClass="int">
		SELECT COUNT(*) totcnt
		FROM UTBL
		WHERE 1=1
		<isEqual prepend="AND" property="searchCondition" compareValue="0">
			ID LIKE '%' || #searchKeyword# || '%'
		</isEqual>
		<isEqual prepend="AND" property="searchCondition" compareValue="1">
			NAME LIKE '%' || #searchKeyword# || '%'
		</isEqual>
	</select>
	
	
</sqlMap>
